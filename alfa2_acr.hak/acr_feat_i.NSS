////////////////////////////////////////////////////////////////////////////////
//
//  System Name : ALFA Core Rules
//     Filename : acr_feat_i
//      Version : 0.5
//         Date : 2011-09-08
//       Author : Ronan
//
//  Local Variable Prefix = ACR_FEAT
//
//
//  Dependencies external of nwscript: feat.2da
//
//  Description
//  This script contains all the ACR hooks for handling custom feats.
//
//  Revision History
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes ////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

#include "acr_effects_i"

////////////////////////////////////////////////////////////////////////////////
// Constants ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

const float ACR_FEAT_HEARTBEAT_DELAY = 6.0;

const string ACR_FEAT_HEARTBEAT_FLAG = "ACR_FEAT_HB_";

////////////////////////////////////////////////////////////////////////////////
// Structures //////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Global Variables ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Prototypes /////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

//! Returns TRUE if oCreature's nFeat's custom script isn't running, and flags
//! that it is running (so future calls will return FALSE). Should only be called
//! from custom Persistent feat scripts.
int ACR_EnterCustomFeatHeartbeat(object oCreature, int nFeat);

////////////////////////////////////////////////////////////////////////////////
// Function Definitions ////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

int ACR_EnterCustomFeatHeartbeat(object oCreature, int nFeat) {
	if(GetLocalInt(oCreature, ACR_FEAT_HEARTBEAT_FLAG + IntToString(nFeat)))
		return FALSE;
	
	SetLocalInt(oCreature, ACR_FEAT_HEARTBEAT_FLAG + IntToString(nFeat), TRUE);
	
	return TRUE;
}