////////////////////////////////////////////////////////////////////////////////
//
//  System Name : ACR GUI Script
//     Filename : gui_it_pickupequip
//    $Revision:: 505        $ current version of the file
//        $Date:: 2008-09-06#$ date the file was created or modified
//       Author : Cipher
//
//    Var Prefix: ACR_GUI
//  Dependencies: None
//
//  Description
//  This script is called from the "Pick Up and Equip" option on the context menu.
//
//  Revision History
//  2008/04/08  Cipher  Inception
//  2008/09/06  AcadiusLost  Added handling for helms and cloaks
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes ////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Constants ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Structures //////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Global Variables ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Prototypes /////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Definitions ////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

void main(int nXP)
{
    object oPC = OBJECT_SELF;
    object oTarget = GetPlayerCurrentTarget(oPC);

    // no security required - anyone can use this script

    // pickup the targetted item
    ActionPickUpItem(oTarget);

    // equip the item depending on the type and what's currently equipped
    switch (GetBaseItemType(oTarget))
    {
        case BASE_ITEM_SMALLSHIELD:
        case BASE_ITEM_LARGESHIELD:
        case BASE_ITEM_TOWERSHIELD:
        case BASE_ITEM_MAGICWAND:
        {
            // equip shields and wands in the left hand slot
            ActionEquipItem(oTarget, INVENTORY_SLOT_LEFTHAND);
            break;
        }
		case BASE_ITEM_HELMET:
		{
            // equip hats/helms in the head slot
            ActionEquipItem(oTarget, INVENTORY_SLOT_HEAD);
            break;
		}
		case BASE_ITEM_CLOAK:
		{
            // equip hats/helms in the head slot
            ActionEquipItem(oTarget, INVENTORY_SLOT_CLOAK);
            break;
		}
        default:
        {
            // check if the left hand slot is open
            if (GetItemInSlot(INVENTORY_SLOT_LEFTHAND) == OBJECT_INVALID)
            {
                // equip the item as a two handed weapon
                ActionEquipItem(oTarget, INVENTORY_SLOT_LEFTHAND);
            }
            else
            {
                // otherwise equip the item as a one handed weapon
                ActionEquipItem(oTarget, INVENTORY_SLOT_RIGHTHAND);
            }
            break;
        }
    }
}